<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Plant-FATE: src/plantfate_patch.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-style-flat.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Plant-FATE
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('plantfate__patch_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">plantfate_patch.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="plantfate__patch_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="plantfate__patch_8h.html">plantfate_patch.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;filesystem&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;csvrow.h&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacepfate.html">pfate</a>{</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#a8b436c6aac2f58c3dd3cba0c979f61d9">    8</a></span>&#160;Patch::Patch(std::string params_file) : S(<span class="stringliteral">&quot;IEBT&quot;</span>, <span class="stringliteral">&quot;rk45ck&quot;</span>) {</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#ae742654848928a5dbd2379e262f11eb9">paramsFile</a> = params_file; <span class="comment">// = &quot;tests/params/p.ini&quot;;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <a class="code" href="classio_1_1Initializer.html">io::Initializer</a> I;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    I.<a class="code" href="classio_1_1Initializer.html#a7c3261fb7e141a0d06d9b0c41de9af66">parse</a>(params_file);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#adb27144cda596255f54b7f0d3abe7dde">parent_dir</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;outDir&quot;</span>);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a5e73008435155be5196fd656dfe59b72">expt_dir</a>   = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;exptName&quot;</span>);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a93041d531e5ae055bf58bcc121296cb5">save_state</a> = (I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;saveState&quot;</span>) == <span class="stringliteral">&quot;yes&quot;</span>)? true : <span class="keyword">false</span>;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a6b204d0bce09370761635535cb60bf07">state_outfile</a>  = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;savedStateFile&quot;</span>);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#aae7cb6e9ee616849fcc51030c66d572c">config_outfile</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;savedConfigFile&quot;</span>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a6717b761d1daecbcc4bef004536056c8">continueFrom_stateFile</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;continueFromState&quot;</span>);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#adc1adec1b45bcfc93c1fb79535ba9251">continueFrom_configFile</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;continueFromConfig&quot;</span>);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a6999f4826cfb1a2218024aa1a6b15ba7">continuePrevious</a> = (<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#adc1adec1b45bcfc93c1fb79535ba9251">continueFrom_configFile</a> != <span class="stringliteral">&quot;null&quot;</span>) &amp;&amp; (<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a6717b761d1daecbcc4bef004536056c8">continueFrom_stateFile</a> != <span class="stringliteral">&quot;null&quot;</span>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a975623dd07c76d5b78ee98de0583fc6b">saveStateInterval</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;saveStateInterval&quot;</span>);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a3065c149095f1c4a4a2e3aa818a59b35">traits_file</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;traitsFile&quot;</span>);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a8b99db3e97cf02acb4e2bcb7659754ff">n_species</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;nSpecies&quot;</span>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a872cb2468008a706cfb6649c92a97046">evolve_traits</a> = (I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;evolveTraits&quot;</span>) == <span class="stringliteral">&quot;yes&quot;</span>)? true : <span class="keyword">false</span>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a1e0a61fd7e98e6af00ed1bebdad96a0d">evolvable_traits</a> = I.<a class="code" href="classio_1_1Initializer.html#a92f49c1ad4e16a85f3f0f12201cb9707">get_vector</a>&lt;std::string&gt;(<span class="stringliteral">&quot;evolvableTraits&quot;</span>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a69c436aba73769ab35e14ca682fa23cf">trait_scalars</a> = I.<a class="code" href="classio_1_1Initializer.html#a92f49c1ad4e16a85f3f0f12201cb9707">get_vector</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;traitScalars&quot;</span>);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a55554e3624281674ee3d8036b765b269">trait_variances</a> = I.<a class="code" href="classio_1_1Initializer.html#a92f49c1ad4e16a85f3f0f12201cb9707">get_vector</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;traitVariances&quot;</span>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a5fff78aefd0dc56845f779ec91f4768c">T_r0_avg</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;T_r0_averaging&quot;</span>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a69c436aba73769ab35e14ca682fa23cf">trait_scalars</a>.size() != <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a1e0a61fd7e98e6af00ed1bebdad96a0d">evolvable_traits</a>.size()) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Please specify as many trait scalars as evolvable traits&quot;</span>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a55554e3624281674ee3d8036b765b269">trait_variances</a>.size() != <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a1e0a61fd7e98e6af00ed1bebdad96a0d">evolvable_traits</a>.size()) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Please specify as many trait variances as evolvable traits&quot;</span>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#ad51c006836c8948de58f22f4f7175427">timestep</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;timestep&quot;</span>);  <span class="comment">// timestep</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#aa025879039df4f87e5ec44e6c70e5219">time_unit</a> = I.<a class="code" href="classio_1_1Initializer.html#abbf31e66329bd03f5d968988c5aa1213">get_verbatim</a>(<span class="stringliteral">&quot;time_unit&quot;</span>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a82df543b02a52b078aaff2b37ebead7b">T_cohort_insertion</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;T_cohort_insertion&quot;</span>);    <span class="comment">// Cohort insertion timestep</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#af748396e17b30f9a17d1f9473e3804f2">solver_method</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;solver&quot;</span>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a5d5e7a4551c9d1471007af8c52058497">res</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;resolution&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a749fe89bba82133621f74abb7396f679">T_invasion</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;T_invasion&quot;</span>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a720f50305169ef2ea26ae9af444da578">T_seed_rain_avg</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;T_seed_rain_avg&quot;</span>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a594eff216fc1ea43f19617a91029b66b">T_return</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;T_return&quot;</span>);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#a80128e3f20c12e21640986daf17798e8">i_metFile</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;i_metFile&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#afeb41c6b8bdc66fe10bdb2ea02aa0ab4">a_metFile</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;a_metFile&quot;</span>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#ae27089c4b9fb1b1547b985a1cf502e42">co2File</a>   = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;<span class="keywordtype">string</span>&gt;(<span class="stringliteral">&quot;co2File&quot;</span>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#a8041d11c8f2968d520a88da9d278fb54">update_i_met</a> = (<a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#a80128e3f20c12e21640986daf17798e8">i_metFile</a> == <span class="stringliteral">&quot;null&quot;</span>)? <span class="keyword">false</span> : <span class="keyword">true</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#a90812d927002af407680ea3182c98e58">update_a_met</a> = (<a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#afeb41c6b8bdc66fe10bdb2ea02aa0ab4">a_metFile</a> == <span class="stringliteral">&quot;null&quot;</span>)? <span class="keyword">false</span> : <span class="keyword">true</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#a145bdd904cb4c5a638885e4a30715fdc">update_co2</a>   = (<a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#ae27089c4b9fb1b1547b985a1cf502e42">co2File</a>   == <span class="stringliteral">&quot;null&quot;</span>)? <span class="keyword">false</span> : <span class="keyword">true</span>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a212f51188727deb3c00b1a9ed9d6f313">props</a>.<a class="code" href="classpfate_1_1CommunityProperties.html#a7000f9b6f1faa3fbf24cf72800088b54">emgProps_file</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;std::string&gt;(<span class="stringliteral">&quot;emgProps&quot;</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a212f51188727deb3c00b1a9ed9d6f313">props</a>.<a class="code" href="classpfate_1_1CommunityProperties.html#a77ff093b5f19fb360cc2e773d369b545">cwmAvg_file</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;std::string&gt;(<span class="stringliteral">&quot;cwmAvg&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a212f51188727deb3c00b1a9ed9d6f313">props</a>.<a class="code" href="classpfate_1_1CommunityProperties.html#a8bec5745a8e5b1ae0a5fc5e9735d5d2a">cwmperSpecies_file</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;std::string&gt;(<span class="stringliteral">&quot;cwmperSpecies&quot;</span>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a212f51188727deb3c00b1a9ed9d6f313">props</a>.<a class="code" href="classpfate_1_1CommunityProperties.html#a46a94cdef86c8361a7aa1d71c9dd3abe">traits_file</a> = I.<a class="code" href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">get</a>&lt;std::string&gt;(<span class="stringliteral">&quot;traits&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#ab4c96a4ee454126766b0f135228643df">traits0</a>.<a class="code" href="classplant_1_1PlantTraits.html#a752ff5e88101f3002440c3cd8879cf31">init</a>(I);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#af40afab09d5713fb4d351b596cd65f70">par0</a>.<a class="code" href="classplant_1_1PlantParameters.html#a6f4ee512f917665608504a6a893d92f3">init</a>(I);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#ab87c46fbd0576bb7031cb3ca8dbe7126">   65</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpfate_1_1Patch.html#ab87c46fbd0576bb7031cb3ca8dbe7126">Patch::set_i_metFile</a>(std::string file){</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#a80128e3f20c12e21640986daf17798e8">i_metFile</a> = file;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#a8041d11c8f2968d520a88da9d278fb54">update_i_met</a> = (file == <span class="stringliteral">&quot;&quot;</span>)? <span class="keyword">false</span> : <span class="keyword">true</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#a65bb4cfd0e87dd7017811a6ff1737722">   71</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpfate_1_1Patch.html#a65bb4cfd0e87dd7017811a6ff1737722">Patch::set_a_metFile</a>(std::string file){</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#afeb41c6b8bdc66fe10bdb2ea02aa0ab4">a_metFile</a> = file;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#a90812d927002af407680ea3182c98e58">update_a_met</a> = (file == <span class="stringliteral">&quot;&quot;</span>)? <span class="keyword">false</span> : <span class="keyword">true</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#ae3329fc40060265528e302fd75bd3b20">   77</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpfate_1_1Patch.html#ae3329fc40060265528e302fd75bd3b20">Patch::set_co2File</a>(std::string co2file){</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#ae27089c4b9fb1b1547b985a1cf502e42">co2File</a> = co2file;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#a145bdd904cb4c5a638885e4a30715fdc">update_co2</a> = (co2file == <span class="stringliteral">&quot;&quot;</span>)? <span class="keyword">false</span> : <span class="keyword">true</span>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#ab58a899c33839507b147bc7a59a2d5c2">   83</a></span>&#160;std::vector&lt;plant::PlantTraits&gt; <a class="code" href="classpfate_1_1Patch.html#ab58a899c33839507b147bc7a59a2d5c2">Patch::readTraitsFromFile</a>(std::string fname){</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    std::ifstream fin(fname.c_str());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">if</span> (!fin){</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Could not open file &quot;</span> + fname + <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    std::vector&lt;plant::PlantTraits&gt; species;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// read header</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    flare::CSVRow row;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    fin &gt;&gt; row;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classplant_1_1PlantTraits.html">plant::PlantTraits</a> traits;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// read time column for all rows</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">while</span>(fin &gt;&gt; row){</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        std::string cell;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        cell = row[1];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        traits.<a class="code" href="classplant_1_1PlantTraits.html#a6e76d3f69afac02fc28949acc713936b">species_name</a> = cell; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        cell = row[4];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">if</span> (cell != <span class="stringliteral">&quot;&quot;</span> &amp;&amp; cell != <span class="stringliteral">&quot;NA&quot;</span>) traits.<a class="code" href="classplant_1_1PlantTraits.html#a4cd6d86786c24681481457ecaa322f3f">wood_density</a> = std::stod(cell)*1000; <span class="comment">// g/cc to kg/m3</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">else</span> traits.<a class="code" href="classplant_1_1PlantTraits.html#a4cd6d86786c24681481457ecaa322f3f">wood_density</a> = 686.638;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        cell = row[5];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">if</span> (cell != <span class="stringliteral">&quot;&quot;</span> &amp;&amp; cell != <span class="stringliteral">&quot;NA&quot;</span>) traits.<a class="code" href="classplant_1_1PlantTraits.html#a9c0407f9468478d653f2b5b776ab227b">hmat</a> = std::stod(cell);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">else</span> traits.<a class="code" href="classplant_1_1PlantTraits.html#a9c0407f9468478d653f2b5b776ab227b">hmat</a> = 23.99;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        cell = row[6];</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">if</span> (cell != <span class="stringliteral">&quot;&quot;</span> &amp;&amp; cell != <span class="stringliteral">&quot;NA&quot;</span>) traits.<a class="code" href="classplant_1_1PlantTraits.html#abdfad8afcd127e5d5627095f278cf1b1">lma</a> = std::stod(cell)*1e-3;  <span class="comment">// convert g/m2 to kg/m2</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">else</span> traits.<a class="code" href="classplant_1_1PlantTraits.html#abdfad8afcd127e5d5627095f278cf1b1">lma</a> = 0.119378;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        cell = row[7];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordflow">if</span> (cell != <span class="stringliteral">&quot;&quot;</span> &amp;&amp; cell != <span class="stringliteral">&quot;NA&quot;</span>) traits.<a class="code" href="classplant_1_1PlantTraits.html#a0d988211ceeb41469feff46a048fa956">p50_xylem</a> = std::stod(cell); </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">else</span> traits.<a class="code" href="classplant_1_1PlantTraits.html#a0d988211ceeb41469feff46a048fa956">p50_xylem</a> = -2.29;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="comment">// ignore further data (for now)    </span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        species.push_back(traits);      </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">return</span> species;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#ad2e4b86b03a6a6834a363bf19c1d9587">  129</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpfate_1_1Patch.html#ad2e4b86b03a6a6834a363bf19c1d9587">Patch::init</a>(<span class="keywordtype">double</span> tstart, <span class="keywordtype">double</span> tend){</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a19c5c9eff1e66dc0ec75773ed60738ff">out_dir</a>  = <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#adb27144cda596255f54b7f0d3abe7dde">parent_dir</a>  + <span class="stringliteral">&quot;/&quot;</span> + <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a5e73008435155be5196fd656dfe59b72">expt_dir</a>; <span class="comment">// TODO: Move to config::init()?</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// string command = &quot;mkdir -p &quot; + out_dir;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    std::filesystem::create_directories(<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a19c5c9eff1e66dc0ec75773ed60738ff">out_dir</a>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// string command2 = &quot;cp &quot; + paramsFile + &quot; &quot; + out_dir + &quot;/p.ini&quot;;</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    std::string copy_to = <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a19c5c9eff1e66dc0ec75773ed60738ff">out_dir</a> + <span class="stringliteral">&quot;/p.ini&quot;</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">if</span> (std::filesystem::exists(copy_to)) std::filesystem::remove(copy_to); <span class="comment">// use this because the overwrite flag in below command does not work!</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    std::filesystem::copy_file(<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#ae742654848928a5dbd2379e262f11eb9">paramsFile</a>, copy_to, std::filesystem::copy_options::overwrite_existing);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// int sysresult;</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// sysresult = system(command.c_str());</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// sysresult = system(command2.c_str());</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// ~~~~~~~ Set up time-points ~~~~~~~~~~~~~~~</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#ac75e323e6e233456b09bb02d1012b04e">y0</a> = tstart; <span class="comment">//I.get&lt;double&gt;(&quot;year0&quot;);</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a3f90f885ff0084b1a809159266326bd8">yf</a> = tend;   <span class="comment">//I.get&lt;double&gt;(&quot;yearf&quot;);</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a5852215889d3dad7d991bf0fc38ec2cf">ye</a> = <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#ac75e323e6e233456b09bb02d1012b04e">y0</a> + <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a5fff78aefd0dc56845f779ec91f4768c">T_r0_avg</a> + 20;  <span class="comment">// year in which trait evolution starts (need to allow this period because r0 is averaged over previous time)</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a3868231658ef110c9af7af35ee9be69b">ts</a>.set_units(<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#aa025879039df4f87e5ec44e6c70e5219">time_unit</a>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#af40afab09d5713fb4d351b596cd65f70">par0</a>.<a class="code" href="classplant_1_1PlantParameters.html#a7a0dc41bcb06a66292f3040918893c4b">set_tscale</a>(<a class="code" href="classpfate_1_1Patch.html#a3868231658ef110c9af7af35ee9be69b">ts</a>.get_tscale());</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#ad6da7a3a21e9237ca8cd1e4a631b06b3">t_next_disturbance</a> = <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#ac75e323e6e233456b09bb02d1012b04e">y0</a> + <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a594eff216fc1ea43f19617a91029b66b">T_return</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a6b6b7ac3f4a4017b2f534279fc7afec3">t_next_invasion</a>    = <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#ac75e323e6e233456b09bb02d1012b04e">y0</a> + <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a749fe89bba82133621f74abb7396f679">T_invasion</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a0e9956fd78450b7b554787314d0f6d99">t_next_savestate</a>   = <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#ac75e323e6e233456b09bb02d1012b04e">y0</a>; <span class="comment">// this will write state once at the beginning too, which is probably unnecessary</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a871b9cac7034dc81fb04449971952570">t_next_writestate</a>  = <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#ac75e323e6e233456b09bb02d1012b04e">y0</a>; <span class="comment">// this will write state once at the beginning too, which is probably unnecessary</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// ~~~~~~~ Set up environment ~~~~~~~~~~~~~~~</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a59eda2b21a7d954f754ecdf07a36e198">E</a>.<a class="code" href="classpfate_1_1env_1_1LightEnvironment.html#a27588f976abcb0b5e32271cb475c2ee6">use_ppa</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a59eda2b21a7d954f754ecdf07a36e198">E</a>.<a class="code" href="classpfate_1_1env_1_1Climate.html#a75a84463176cf6c2c86192959fdb686b">set_elevation</a>(0);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a59eda2b21a7d954f754ecdf07a36e198">E</a>.<a class="code" href="classpfate_1_1env_1_1Climate.html#ad15a02a1fa35c5d34d8b46f4a58421fb">set_acclim_timescale</a>(7); </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">climate_stream</a>.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#af886bf0c88d29c9460067a124c000f3d">init</a>();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// ~~~~~~~~~~ Create solver ~~~~~~~~~~~~~~~~~~~~~~~~~</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a> = Solver(<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#af748396e17b30f9a17d1f9473e3804f2">solver_method</a>, <span class="stringliteral">&quot;rk45ck&quot;</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.control.abm_n0 = 20;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.control.ode_ifmu_stepsize = 1e20; <span class="comment">//timestep; //0.02; //0.0833333;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.control.cohort_insertion_dt = <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a82df543b02a52b078aaff2b37ebead7b">T_cohort_insertion</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.control.sync_cohort_insertion = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.control.ifmu_centered_grids = <span class="keyword">false</span>; <span class="comment">//true;</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.control.ebt_ucut = 1e-7;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.control.cm_use_log_densities = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// S.control.cohort_insertion_tol = 1e-6;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.setEnvironment(&amp;<a class="code" href="classpfate_1_1Patch.html#a59eda2b21a7d954f754ecdf07a36e198">E</a>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// Add species</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a6999f4826cfb1a2218024aa1a6b15ba7">continuePrevious</a>){</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <a class="code" href="namespacepfate.html#acf2c2a4b2aac6abc0c2c61691e3b0f21">restoreState</a>(*<span class="keyword">this</span>, <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a6717b761d1daecbcc4bef004536056c8">continueFrom_stateFile</a>, <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#adc1adec1b45bcfc93c1fb79535ba9251">continueFrom_configFile</a>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#ac75e323e6e233456b09bb02d1012b04e">y0</a> = <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.current_time; <span class="comment">// replace y0</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">// ~~~~~~~~~~ Read initial trait values ~~~~~~~~~~~~~~~~~~~~~~~~~</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        std::vector&lt;plant::PlantTraits&gt; file_species = <a class="code" href="classpfate_1_1Patch.html#ab58a899c33839507b147bc7a59a2d5c2">readTraitsFromFile</a>(<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a3065c149095f1c4a4a2e3aa818a59b35">traits_file</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; s : file_species){</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            std::cout &lt;&lt; s.species_name &lt;&lt; <span class="stringliteral">&quot;:  &quot;</span> &lt;&lt; s.lma &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; s.wood_density &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; s.hmat &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; s.p50_xylem &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">// ~~~ Create initial resident species pool from traits file ~~~~</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a8b99db3e97cf02acb4e2bcb7659754ff">n_species</a>; ++i){</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <a class="code" href="classplant_1_1PlantTraits.html">plant::PlantTraits</a> traits = <a class="code" href="classpfate_1_1Patch.html#ab4c96a4ee454126766b0f135228643df">traits0</a>; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            traits.<a class="code" href="classplant_1_1PlantTraits.html#a6e76d3f69afac02fc28949acc713936b">species_name</a> = file_species[i].species_name;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            traits.<a class="code" href="classplant_1_1PlantTraits.html#abdfad8afcd127e5d5627095f278cf1b1">lma</a>          = file_species[i].lma;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            traits.<a class="code" href="classplant_1_1PlantTraits.html#a4cd6d86786c24681481457ecaa322f3f">wood_density</a> = file_species[i].wood_density;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            traits.<a class="code" href="classplant_1_1PlantTraits.html#a9c0407f9468478d653f2b5b776ab227b">hmat</a>         = file_species[i].hmat;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            traits.<a class="code" href="classplant_1_1PlantTraits.html#a0d988211ceeb41469feff46a048fa956">p50_xylem</a>    = file_species[i].p50_xylem; <span class="comment">// runif(-3.5,-0.5);</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <a class="code" href="classpfate_1_1Patch.html#ac014924ea9c6590fa2031788057cf271">addSpeciesAndProbes</a>(<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#ac75e323e6e233456b09bb02d1012b04e">y0</a>, traits);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="comment">// S.resetState(y0);</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.initialize(<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#ac75e323e6e233456b09bb02d1012b04e">y0</a>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    } </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">//  std::random_shuffle(S.species_vec.begin(), S.species_vec.end());</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.print();  </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// sio.S = &amp;S;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a212f51188727deb3c00b1a9ed9d6f313">props</a>.<a class="code" href="classpfate_1_1CommunityProperties.html#ac56567794c0dd3291d53070d6ba419b0">openStreams</a>(<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a19c5c9eff1e66dc0ec75773ed60738ff">out_dir</a>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#ab76971ff4ca9bf75128d6bbe186d9456">  209</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpfate_1_1Patch.html#ab76971ff4ca9bf75128d6bbe186d9456">Patch::close</a>(){</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">//S.print();</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a212f51188727deb3c00b1a9ed9d6f313">props</a>.<a class="code" href="classpfate_1_1CommunityProperties.html#a9adebb940a7212442167bd4a5be57442">closeStreams</a>();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="namespacepfate.html#aa3b7425f62503d7549ea5237bccee611">saveState</a>(*<span class="keyword">this</span>, </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;              <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a19c5c9eff1e66dc0ec75773ed60738ff">out_dir</a> + <span class="stringliteral">&quot;/&quot;</span> + <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a6b204d0bce09370761635535cb60bf07">state_outfile</a>, </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;              <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a19c5c9eff1e66dc0ec75773ed60738ff">out_dir</a> + <span class="stringliteral">&quot;/&quot;</span> + <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#aae7cb6e9ee616849fcc51030c66d572c">config_outfile</a>, </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;              <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#ae742654848928a5dbd2379e262f11eb9">paramsFile</a>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// free memory associated</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.species_vec) <span class="keyword">delete</span> <span class="keyword">static_cast&lt;</span><a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>*<span class="keyword">&gt;</span>(s); </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#a9e206a8b8ffc34c68e42a30eaf096461">  224</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classpfate_1_1Patch.html#a9e206a8b8ffc34c68e42a30eaf096461">Patch::runif</a>(<span class="keywordtype">double</span> rmin, <span class="keywordtype">double</span> rmax){</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">double</span> r = double(rand())/RAND_MAX; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> rmin + (rmax-rmin)*r;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#ae819ff5787441c244a4b0414b3153761">  230</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpfate_1_1Patch.html#ae819ff5787441c244a4b0414b3153761">Patch::removeSpeciesAndProbes</a>(<a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>* spp){</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// delete species probes and remove their pointers from solver</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : spp-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#a35357aa983a17460c9bd68475014e258">probes</a>){ <span class="comment">// probes vector is not modified in the loop, so we can use it directly to iterate</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keyword">delete</span> p;               <span class="comment">// this will delete the object, but the pointer p and its copy in the solver remain</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.removeSpecies(p);    <span class="comment">// this will remove its pointer from the solver</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">// delete the resident itself and remove its pointer from solver</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keyword">delete</span> spp;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.removeSpecies(spp);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// update state vector</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.copyCohortsToState();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#ac014924ea9c6590fa2031788057cf271">  246</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpfate_1_1Patch.html#ac014924ea9c6590fa2031788057cf271">Patch::addSpeciesAndProbes</a>(<span class="keywordtype">double</span> t, <span class="keyword">const</span> <a class="code" href="classplant_1_1PlantTraits.html">plant::PlantTraits</a>&amp; traits){</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="classpfate_1_1PSPM__Plant.html">PSPM_Plant</a> p1;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">//p1.initFromFile(paramsFile);</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    p1.<a class="code" href="classplant_1_1Plant.html#a99d31208f7afa12bc10ee138bf190ef8">init</a>(<a class="code" href="classpfate_1_1Patch.html#af40afab09d5713fb4d351b596cd65f70">par0</a>, traits);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    ((<a class="code" href="classplant_1_1Plant.html">plant::Plant</a>*)&amp;p1)-&gt;print();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">//p1.geometry.set_lai(p1.par.lai0); // these are automatically set by init_state() in pspm_interface</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    p1.<a class="code" href="classpfate_1_1PSPM__Plant.html#a47f004a9746c6c04eb34bc94b29690ff">set_size</a>({0.01});</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>* spp = <span class="keyword">new</span> <a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>(p1);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    spp-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#a3434c527d0ba1e10962c678415c73501">species_name</a> = traits.<a class="code" href="classplant_1_1PlantTraits.html#a6e76d3f69afac02fc28949acc713936b">species_name</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    spp-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#a69c96cd799aeebe19d5f4123148c93e0">evolvable_traits</a> = <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a1e0a61fd7e98e6af00ed1bebdad96a0d">evolvable_traits</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    spp-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#a349ba6112d565d673881c8248ab577cc">trait_scalars</a> = <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a69c436aba73769ab35e14ca682fa23cf">trait_scalars</a>; <span class="comment">//{800, 25};</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    spp-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#a44bcfeaa9449f2c6254ea36ffe063adc">trait_variance</a> = <a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a55554e3624281674ee3d8036b765b269">trait_variances</a>; <span class="comment">// vector&lt;double&gt;(2, 0.01);</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    spp-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#a34963655822db7560d9aab4766993e55">r0_hist</a>.<a class="code" href="classMovingAverager.html#a2aeb3873ec0fc25b9db25ba57a9a67a5">set_interval</a>(<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a5fff78aefd0dc56845f779ec91f4768c">T_r0_avg</a>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    spp-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#ad63cdf7980f7920a48437f869c53136e">t_introduction</a> = t;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    spp-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#ac8d1a887bb193e1595def1e8923d3964">seeds_hist</a>.<a class="code" href="classMovingAverager.html#a2aeb3873ec0fc25b9db25ba57a9a67a5">set_interval</a>(<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a720f50305169ef2ea26ae9af444da578">T_seed_rain_avg</a>);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a872cb2468008a706cfb6649c92a97046">evolve_traits</a>) spp-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#a16515855c9263b486fad79596b693726">createVariants</a>(p1);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// Add resident species to solver</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.addSpecies({<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a5d5e7a4551c9d1471007af8c52058497">res</a>)}, {0.01}, {10}, {<span class="keyword">true</span>}, spp, 2, 1e-3);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">//S.addSpecies({0.01, 0.0100001}, spp, 3, 1e-3);</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">// Add variants (probes) to solver</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a872cb2468008a706cfb6649c92a97046">evolve_traits</a>){</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> m : <span class="keyword">static_cast&lt;</span><a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>*<span class="keyword">&gt;</span>(spp)-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#a35357aa983a17460c9bd68475014e258">probes</a>) </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <a class="code" href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">S</a>.addSpecies({<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">config</a>.<a class="code" href="classpfate_1_1PlantFateConfig.html#a5d5e7a4551c9d1471007af8c52058497">res</a>)}, {0.01}, {10}, {<span class="keyword">true</span>}, m, 2, 1e-3);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    S.copyCohortsToState();</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#a5fca641f79caa40b94e8c380f6066ba4">  284</a></span>&#160;<span class="keywordtype">void</span> Patch::shuffleSpecies(){</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// Shuffle species in the species vector -- just for debugging</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;shuffling...\n&quot;</span>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    std::random_shuffle(S.species_vec.begin(), S.species_vec.end());</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    S.copyCohortsToState();</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#a6b3051aafdf57fe194a9fd1236808dd3">  292</a></span>&#160;<span class="keywordtype">void</span> Patch::removeDeadSpecies(<span class="keywordtype">double</span> t){</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// Remove dead species</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    vector&lt;AdaptiveSpecies&lt;PSPM_Plant&gt;*&gt; toRemove;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;S.species_vec.size(); ++k){</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keyword">auto</span> spp = <span class="keyword">static_cast&lt;</span><a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>*<span class="keyword">&gt;</span>(S.species_vec[k]);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">if</span> (spp-&gt;isResident){</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordflow">if</span> (props.species.n_ind_vec[k] &lt; 1e-6 &amp;&amp; (t-spp-&gt;t_introduction) &gt; 50) toRemove.push_back(spp);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> spp : toRemove) removeSpeciesAndProbes(spp);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#a67db3c7628f58088f2d0e7bec6ccb6b9">  305</a></span>&#160;<span class="keywordtype">void</span> Patch::addRandomSpecies(<span class="keywordtype">double</span> t){</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;**** Invasion ****\n&quot;</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="classplant_1_1PlantTraits.html">plant::PlantTraits</a> traits = traits0;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    traits.<a class="code" href="classplant_1_1PlantTraits.html#a6e76d3f69afac02fc28949acc713936b">species_name</a> = <span class="stringliteral">&quot;spp_t&quot;</span>+to_string(t);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    traits.<a class="code" href="classplant_1_1PlantTraits.html#abdfad8afcd127e5d5627095f278cf1b1">lma</a>          = runif(0.05, 0.25);    <span class="comment">//Tr.species[i].lma, </span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    traits.<a class="code" href="classplant_1_1PlantTraits.html#a4cd6d86786c24681481457ecaa322f3f">wood_density</a> = runif(300, 900);   <span class="comment">//Tr.species[i].wood_density, </span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    traits.<a class="code" href="classplant_1_1PlantTraits.html#a9c0407f9468478d653f2b5b776ab227b">hmat</a>         = runif(2, 35);      <span class="comment">//Tr.species[i].hmat, </span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    traits.<a class="code" href="classplant_1_1PlantTraits.html#a0d988211ceeb41469feff46a048fa956">p50_xylem</a>    = -2.29; <span class="comment">//runif(-6, -0.5);   //Tr.species[i].p50_xylem);</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    addSpeciesAndProbes(t, traits);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#a735460380b7ce3b6dacd6fdf3055aedc">  318</a></span>&#160;<span class="keywordtype">void</span> Patch::evolveTraits(<span class="keywordtype">double</span> t, <span class="keywordtype">double</span> dt_evolution){</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> spp : S.species_vec) <span class="keyword">static_cast&lt;</span><a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>*<span class="keyword">&gt;</span>(spp)-&gt;calcFitnessGradient();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> spp : S.species_vec) <span class="keyword">static_cast&lt;</span><a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>*<span class="keyword">&gt;</span>(spp)-&gt;evolveTraits(dt_evolution);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;}</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#ac4a51c6e3453e2bd4c3df67ce844862f">  323</a></span>&#160;<span class="keywordtype">void</span> Patch::disturbPatch(<span class="keywordtype">double</span> t){</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> spp : S.species_vec){</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;spp-&gt;xsize(); ++i){</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keyword">auto</span>&amp; p = (<span class="keyword">static_cast&lt;</span><a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>*<span class="keyword">&gt;</span>(spp))-&gt;getCohort(i);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            p.geometry.lai = p.par.lai0;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordtype">double</span> u_new = spp-&gt;getU(i) * 0 * double(rand())/RAND_MAX;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            spp-&gt;setU(i, u_new);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        spp-&gt;setX(spp-&gt;xsize()-1, spp-&gt;xb);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    S.copyCohortsToState();</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">// FIXME: Setting const input seed rain for mutants doesnt work. Is that a problem? </span></div>
<div class="line"><a name="l00345"></a><span class="lineno"><a class="line" href="group__trait__evolution.html#ga493d1e9d19f70f7e122897c6aac0abf1">  345</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> Patch::calc_seedrain_r0(<span class="keywordtype">double</span> t){</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// calculate output seed rain at time t, S(t)</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    vector&lt;double&gt; seeds = S.newborns_out(t);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;seeds.size(); ++k){</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">if</span> (seeds[k] &lt; 0){</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;seeds[&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; seeds[k] &lt;&lt; endl;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            S.print();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keyword">static_cast&lt;</span><a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>*<span class="keyword">&gt;</span>(S.species_vec[k])-&gt;seeds_hist.print_summary(); </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            cout.flush();</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">// calculate r0 and update input seed rain</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;S.species_vec.size(); ++k){</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keyword">auto</span> spp = <span class="keyword">static_cast&lt;</span><a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>*<span class="keyword">&gt;</span>(S.species_vec[k]);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordtype">double</span> dt = t - spp-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#ac8d1a887bb193e1595def1e8923d3964">seeds_hist</a>.<a class="code" href="classMovingAverager.html#a10228b285298b40e5fd3056dc943302e">get_last_t</a>(); <span class="comment">// Note: Due to this line, first value of r0 will be garbage, unless initialized!</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">if</span> (dt &lt; config.timestep/2){</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;dt = &quot;</span> &lt;&lt; dt &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            spp-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#a34963655822db7560d9aab4766993e55">r0_hist</a>.<a class="code" href="classMovingAverager.html#ad597933657a823696ab02aad3442c38a">print</a>();</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            spp-&gt;seeds_hist.print();</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;r0 dt is less than the timestep!&quot;</span>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        spp-&gt;seeds_hist.push(t, seeds[k]);        <span class="comment">// Push S(t) into averager so that S_avg(t) can be computed</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordtype">double</span> seeds_in = spp-&gt;birth_flux_in;     <span class="comment">// This was S_avg(t-dt)</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordtype">double</span> seeds_out = spp-&gt;seeds_hist.get(); <span class="comment">// This is  S_avg(t),    i.e. average over seed-rain-avg interval, either a year or successional time window </span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordtype">double</span> eps = 1e-20;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordtype">double</span> r0 = log((seeds_out+eps)/(seeds_in+eps))/dt;   <span class="comment">// t0 = (log(S_avg(t)/S_avg(t-dt))/dt</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        spp-&gt;set_inputBirthFlux(seeds_out);       <span class="comment">// S_avg(t) will be input for next step</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        spp-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#a34963655822db7560d9aab4766993e55">r0_hist</a>.<a class="code" href="classMovingAverager.html#a01b3f4dcb3098d698c92f1131adf0101">push</a>(t, r0);                 <span class="comment">// r0 is averaged again for better evolutoinary convergence </span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="comment">// spp-&gt;r0_hist.print_summary();</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;}</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#a7f6751c9c0efe222201a24fc2d400788">  386</a></span>&#160;<span class="keywordtype">void</span> Patch::simulate_to(<span class="keywordtype">double</span> t){</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (<span class="keywordtype">int</span>(t*12) % 12 == 0){</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordtype">double</span> t_years_ce = flare::julian_to_yearsCE(ts.to_julian(S.current_time));</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordtype">double</span> tplus_years_ce = flare::julian_to_yearsCE(ts.to_julian(t));</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;stepping = &quot;</span> &lt;&lt; setprecision(6) &lt;&lt; S.current_time &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; t_years_ce &lt;&lt; <span class="stringliteral">&quot; CE)&quot;</span> &lt;&lt; <span class="stringliteral">&quot; --&gt; &quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; tplus_years_ce &lt;&lt; <span class="stringliteral">&quot; CE)&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t(&quot;</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> spp : S.species_vec) cout &lt;&lt; spp-&gt;xsize() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">// Step size to be used for evolutionary dynamics, </span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">// since trait evolution is done after completing step_to call</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordtype">double</span> dt_evol = t - S.current_time; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// perform step</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keyword">auto</span> after_step = [<span class="keyword">this</span>](<span class="keywordtype">double</span> _t){</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="comment">// Calc r0, update seed rain</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="comment">// calc_seedrain_r0(_t);</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    };</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    S.step_to(t, after_step);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// update r0 and seed rain after step</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// this implies that seed tain and r0 are not updated during internal steps - I think thats okay.</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    calc_seedrain_r0(t);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">// evolve traits</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span> (config.evolve_traits &amp;&amp; t &gt; config.ye){</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        evolveTraits(t, dt_evol);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">// update output metrics - needed before removeDeadSpecies()</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    props.update(t, *<span class="keyword">this</span>);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// write outputs - must be done before species list is altered</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">if</span> (t &gt; t_next_writestate || fabs(t-t_next_writestate) &lt; 1e-6){</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        props.writeOut(t, *<span class="keyword">this</span>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        t_next_writestate += 1;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// remove species whose total abundance has fallen below threshold (its probes are also removed)</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    removeDeadSpecies(t); <span class="comment">// needs updated props for reading species abundances</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// Invasion by a random new species</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (t &gt;= t_next_invasion){</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        addRandomSpecies(t);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        t_next_invasion = t + config.T_invasion;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// clear patch by disturbance   </span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> (t &gt;= t_next_disturbance){</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        disturbPatch(t);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordtype">double</span> dt_next = -log(<span class="keywordtype">double</span>(rand())/RAND_MAX) * config.T_return;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        dt_next = std::clamp(dt_next, 0.0, 10*config.T_return);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        t_next_disturbance = t + dt_next;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="comment">// Save simulation state at specified intervals</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span> (t &gt; t_next_savestate || fabs(t-t_next_savestate) &lt; 1e-6){</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <a class="code" href="namespacepfate.html#aa3b7425f62503d7549ea5237bccee611">saveState</a>(*<span class="keyword">this</span>, </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            config.out_dir + <span class="stringliteral">&quot;/&quot;</span> + std::to_string(t) + <span class="stringliteral">&quot;_&quot;</span> + config.state_outfile, </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            config.out_dir + <span class="stringliteral">&quot;/&quot;</span> + std::to_string(t) + <span class="stringliteral">&quot;_&quot;</span> + config.config_outfile, </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            config.paramsFile);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        t_next_savestate += config.saveStateInterval;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">// Shuffle species - just for debugging. result shouldnt change</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// if (fabs(t-int(t)) &lt; 1e-6 &amp;&amp; (int(t) % 10) == 0) shuffleSpecies(); </span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;}</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#a4ef446560886e3bc56e08e196ee17827">  456</a></span>&#160;<span class="keywordtype">void</span> Patch::update_climate(<span class="keywordtype">double</span> julian_time, <a class="code" href="classpfate_1_1env_1_1ClimateStream.html">env::ClimateStream</a>&amp; c_stream){</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    c_stream.<a class="code" href="classpfate_1_1env_1_1ClimateStream.html#a259d5b50ebd9d8e801ee6cd079f6fb75">updateClimate</a>(julian_time, E);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;}</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#a7659e2f363200738e1699c030ac2c23b">  461</a></span>&#160;<span class="keywordtype">void</span> Patch::update_climate(<span class="keywordtype">double</span> _co2, <span class="keywordtype">double</span> _tc, <span class="keywordtype">double</span> _vpd, <span class="keywordtype">double</span> _ppfd, <span class="keywordtype">double</span> _swp){</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    E.clim_inst.tc   = _tc;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    E.clim_inst.ppfd = _ppfd;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    E.clim_inst.rn   = _ppfd/2;  <span class="comment">// Tentative, placeholder</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    E.clim_inst.vpd  = _vpd;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    E.clim_inst.co2  = _co2;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    E.clim_inst.swp  = _swp;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;}</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#a95e132a78319775d5b83d367f40b09c2">  470</a></span>&#160;<span class="keywordtype">void</span> Patch::update_climate_acclim(<span class="keywordtype">double</span> t_julian, <span class="keywordtype">double</span> _co2, <span class="keywordtype">double</span> _tc, <span class="keywordtype">double</span> _vpd, <span class="keywordtype">double</span> _ppfd, <span class="keywordtype">double</span> _swp){</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="classpfate_1_1env_1_1Clim.html">env::Clim</a> C = E.clim_acclim;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    C.<a class="code" href="classpfate_1_1env_1_1Clim.html#aa3e81becece17a678bc6e7babbae5df7">tc</a>   = _tc;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    C.<a class="code" href="classpfate_1_1env_1_1Clim.html#a63b47078aa082c156901e63496189c9e">ppfd</a> = _ppfd;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    C.<a class="code" href="classpfate_1_1env_1_1Clim.html#a5d097a8175dfb82053fff2c5c655e88e">rn</a>   = _ppfd/2;  <span class="comment">// Tentative, placeholder</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    C.<a class="code" href="classpfate_1_1env_1_1Clim.html#a159900b7ce44d139c614053e3c28ab27">vpd</a>  = _vpd;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    C.<a class="code" href="classpfate_1_1env_1_1Clim.html#a99d684eb015402b31bdaed6a71fafb39">co2</a>  = _co2;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    C.<a class="code" href="classpfate_1_1env_1_1Clim.html#a589215b140b29e2e21032e095b9d2326">swp</a>  = _swp;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    E.set_forcing_acclim(t_julian, C);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;}</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#ae945da577720468b8fbf6afe71536a3b">  482</a></span>&#160;<span class="keywordtype">void</span> Patch::save(std::ostream &amp;fout){</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;Patch::v1&quot;</span> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">// write patch-specific state</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    fout &lt;&lt; std::make_tuple(</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;              t_next_disturbance</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            , t_next_invasion</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            , t_next_savestate</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            , t_next_writestate)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;         &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// write species names vector</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    fout &lt;&lt; S.species_vec.size() &lt;&lt; <span class="stringliteral">&quot; | &quot;</span>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : S.species_vec){</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keyword">auto</span> spp = <span class="keyword">static_cast&lt;</span><a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>*<span class="keyword">&gt;</span>(s);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        fout &lt;&lt; std::quoted(spp-&gt;species_name) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    fout &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">// write species associations (list of probes)</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : S.species_vec){</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keyword">auto</span> spp = <span class="keyword">static_cast&lt;</span><a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>*<span class="keyword">&gt;</span>(s);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        fout &lt;&lt; std::quoted(spp-&gt;species_name) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        fout &lt;&lt; spp-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#a35357aa983a17460c9bd68475014e258">probes</a>.size() &lt;&lt; <span class="stringliteral">&quot; | &quot;</span>; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : spp-&gt;probes) fout &lt;&lt; std::quoted(p-&gt;species_name) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        fout &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">// save Solver</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    S.save(fout);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;}</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#ab28768ff1b01cb532dfc9bca2d8ce2cb">  514</a></span>&#160;<span class="keywordtype">void</span> Patch::restore(std::istream &amp;fin){</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Restoring Patch...\n&quot;</span>;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    std::string s; fin &gt;&gt; s; <span class="comment">// discard version number</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    assert(s == <span class="stringliteral">&quot;Patch::v1&quot;</span>);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    fin &gt;&gt; t_next_disturbance</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        &gt;&gt; t_next_invasion</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        &gt;&gt; t_next_savestate</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        &gt;&gt; t_next_writestate;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">// Read species associations (probes)</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    vector&lt;string&gt; spp_names;   </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    map&lt;string, int&gt; indices; <span class="comment">// name --&gt; index --- just a map that tells at which index in the species vector the species is located</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    vector&lt;vector&lt;int&gt;&gt; probe_lists;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordtype">int</span> n; fin &gt;&gt; n &gt;&gt; s; <span class="comment">// number of species to read, skip s = &quot; | &quot;</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    spp_names.resize(n); </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    probe_lists.resize(n);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; ++i) fin &gt;&gt; std::quoted(spp_names[i]);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">// map indices</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; ++i){</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        indices[spp_names[i]] = i;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">// Species read: </span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Species read:\n&quot;</span>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;spp_names.size(); ++i) cout &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; indices[spp_names[i]] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; spp_names[i] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">string</span> s : spp_names){</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordtype">string</span> r_name; vector&lt;string&gt; probes_list;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="comment">// read resident name</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        fin &gt;&gt; std::quoted(r_name);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        assert(r_name == s);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="comment">// read probe names</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        fin &gt;&gt; n &gt;&gt; s; <span class="comment">// s has &quot; | &quot; </span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        cout &lt;&lt; spp_names[indices[r_name]] &lt;&lt; <span class="stringliteral">&quot; --&gt; &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; s;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; ++i){</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            fin &gt;&gt; std::quoted(s);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            cout &lt;&lt; spp_names[indices[s]] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            probe_lists[indices[r_name]].push_back(indices[s]);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        cout &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <a class="code" href="classpfate_1_1PSPM__Plant.html">PSPM_Plant</a> p;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    vector&lt;Species_Base*&gt; spp_proto;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;spp_names.size(); ++i){</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keyword">auto</span> spp = <span class="keyword">new</span> <a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>(p);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        spp_proto.push_back(<span class="keyword">static_cast&lt;</span>Species_Base*<span class="keyword">&gt;</span>(spp));</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> spp : spp_proto){</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keyword">static_cast&lt;</span>Species_Base*<span class="keyword">&gt;</span>(spp)-&gt;print();</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">// restore solver</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    S.restore(fin, spp_proto);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">// recreate species associations</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">string</span> s : spp_names){</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keywordtype">int</span> res_id = indices[s];</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keyword">auto</span> spp = <span class="keyword">static_cast&lt;</span><a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>*<span class="keyword">&gt;</span>(S.species_vec[res_id]);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> probe_id : probe_lists[res_id]){</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            spp-&gt;<a class="code" href="classpfate_1_1AdaptiveSpecies.html#a35357aa983a17460c9bd68475014e258">probes</a>.push_back(<span class="keyword">static_cast&lt;</span><a class="code" href="classpfate_1_1AdaptiveSpecies.html">AdaptiveSpecies&lt;PSPM_Plant&gt;</a>*<span class="keyword">&gt;</span>(S.species_vec[probe_id]));</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }   </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;}</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">// To simulate step-by-step </span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">// --------------------------</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">//   1) set the following solver properties:</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">//       --&gt; S.control.ode_ifmu_stepsize = 1e20; // this will ensure that simulate_to() takes only 1 internal step</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">//       --&gt; S.control.cohort_insertion_dt = T_cohort_insertion; // this will insert cohorts automatically at the specified interval</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">//       --&gt; S.control.sync_cohort_insertion = false;  // this will prevent cohort insertion at the end of simulate_to()</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">//   2) simulate in a loop with increments of `timestep`, e.g.,</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">//      for (double t=y0; t &lt;= yf+1e-6; t=t+timestep) {</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">//          updateClimate(S.current_time);</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">//          simulate_to(t);</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">//   3) Climate should be updated once at the beginning of the step, and not in computeEnv(). Consider the following sequence of events</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">//      Ideally, seed input S1 = seed production in interval t0-t1 ==&gt; depends on avg {u,E,C} over t0-t1. Now since dt is small (~day), </span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">//      u,E dont change as much, but C can change substantially from t0 to t1. Hence, B(u0,E0,C)~B(u1,E1,C) so it can be evaluated at end of step in AfterStep(). </span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">//      however, since C changes abruptly at the end of the timestep, we should use C from the step beginnning, which is what plants see throughout </span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">//      the step. If C-update is put in computeEnv, newborns_out() will update C and we will get B(u1,E1,C1) instead of B(u1,E1,C0). Hence, </span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">//      better to manage C ourselves and update it once at the beginning of the timestep.</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">//         S0              S1              S2          ( v = seed rain from current vegetation that turns into seedlings)</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">//                                        ||                                                     ( |        )</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">//          -----.-------&gt; || -----.----&gt; |||||        ( . = seed ) ---&gt;  ( | = seedling ) ---&gt;  ( | = tree )</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">//        -v----/------------v----/-----------v---       </span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">//        {..}_/           {...}_/          {......}   </span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">//         t0              t1              t2</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">//        </span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">//         climate:          C1           </span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">//         C0               ---------------- C2</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">//         _________________                --------</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">//   4) This step-by-step approach is also better suited to spatial simulations, where the entire grid of </span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">//      climate input is read once before the beginning of the step. Otherwise, if each patch tried to read </span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">//      its own input, this will try to update entire grid whenever any patch wants to upfate (inefficient) </span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">//      or worse, create problems when patches are parallelized</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">// To simulate a long interval (we shouldnt use this in Plant-FATE), </span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">// ----------------------------</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">//   1) set the following solver properties:</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">//       --&gt; S.control.ode_ifmu_stepsize = timstep; // this will ensure that simulate_to() internally steps by one `timestep` at a time</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">//       --&gt; S.control.cohort_insertion_dt = T_cohort_insertion; // this will insert cohorts automatically at the specified interval</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">//       --&gt; S.control.sync_cohort_insertion = false;  // this will prevent cohort insertion at the end of simulate_to()</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">//   2) Simulate in one go: simulate_to(T_final) OR </span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">//      break up the simulation into any desired number of intervals, where interval is at least several times the solver internal `timestep` </span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">//      (this is ideal for accuracy and efficiency, but not strictly necessary). E.g.,</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">//      for (double t=y0; t &lt;= yf+1e-6; t=t+T_long) {</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">//          simulate_to(t);</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00633"></a><span class="lineno"><a class="line" href="classpfate_1_1Patch.html#ae003bee4119e3a1122c9e1f8ebc9de28">  633</a></span>&#160;<span class="keywordtype">void</span> Patch::simulate(){</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">double</span> t=config.y0; t &lt;= config.yf+1e-6; t=t+config.timestep) {  <span class="comment">// 1e-6 ensures that last timestep to reach yf is actually executed</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordflow">if</span> (fabs(t - S.current_time) &lt; 1e-6) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="comment">// read forcing inputs</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="comment">// std::cout &lt;&lt; &quot;update Env (explicit)... t = &quot; &lt;&lt; S.current_time &lt;&lt; &quot;:\n&quot;;</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        update_climate(ts.to_julian(S.current_time)+1e-6, climate_stream); <span class="comment">// The 1e-6 is to ensure that when t coincides exactly with time in climate file, we ensure that the value in climate file is read by asking for a slightly higher t</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="comment">// ((env::Climate&amp;)E).print(t);</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="comment">// simulate patch</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        simulate_to(t);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;}</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;} <span class="comment">// namespace pfate</span></div>
<div class="ttc" id="aclassMovingAverager_html_a01b3f4dcb3098d698c92f1131adf0101"><div class="ttname"><a href="classMovingAverager.html#a01b3f4dcb3098d698c92f1131adf0101">MovingAverager::push</a></div><div class="ttdeci">void push(double t, double f)</div><div class="ttdef"><b>Definition:</b> <a href="moving__average_8h_source.html#l00031">moving_average.h:31</a></div></div>
<div class="ttc" id="aclassMovingAverager_html_a10228b285298b40e5fd3056dc943302e"><div class="ttname"><a href="classMovingAverager.html#a10228b285298b40e5fd3056dc943302e">MovingAverager::get_last_t</a></div><div class="ttdeci">double get_last_t()</div><div class="ttdef"><b>Definition:</b> <a href="moving__average_8h_source.html#l00080">moving_average.h:80</a></div></div>
<div class="ttc" id="aclassMovingAverager_html_a2aeb3873ec0fc25b9db25ba57a9a67a5"><div class="ttname"><a href="classMovingAverager.html#a2aeb3873ec0fc25b9db25ba57a9a67a5">MovingAverager::set_interval</a></div><div class="ttdeci">void set_interval(double _T)</div><div class="ttdef"><b>Definition:</b> <a href="moving__average_8h_source.html#l00027">moving_average.h:27</a></div></div>
<div class="ttc" id="aclassMovingAverager_html_ad597933657a823696ab02aad3442c38a"><div class="ttname"><a href="classMovingAverager.html#ad597933657a823696ab02aad3442c38a">MovingAverager::print</a></div><div class="ttdeci">void print()</div><div class="ttdef"><b>Definition:</b> <a href="moving__average_8h_source.html#l00098">moving_average.h:98</a></div></div>
<div class="ttc" id="aclassio_1_1Initializer_html"><div class="ttname"><a href="classio_1_1Initializer.html">io::Initializer</a></div><div class="ttdoc">A simple initializer that reads parameters from an ini file.</div><div class="ttdef"><b>Definition:</b> <a href="initializer__v2_8h_source.html#l00059">initializer_v2.h:59</a></div></div>
<div class="ttc" id="aclassio_1_1Initializer_html_a098a8511a950a4449925c8315af36bdb"><div class="ttname"><a href="classio_1_1Initializer.html#a098a8511a950a4449925c8315af36bdb">io::Initializer::get</a></div><div class="ttdeci">T get(const std::string &amp;sectionname, const std::string &amp;keyname) const</div><div class="ttdef"><b>Definition:</b> <a href="initializer__v2_8h_source.html#l00130">initializer_v2.h:130</a></div></div>
<div class="ttc" id="aclassio_1_1Initializer_html_a7c3261fb7e141a0d06d9b0c41de9af66"><div class="ttname"><a href="classio_1_1Initializer.html#a7c3261fb7e141a0d06d9b0c41de9af66">io::Initializer::parse</a></div><div class="ttdeci">void parse(std::istream &amp;in, bool add=false, bool verbose=false)</div><div class="ttdef"><b>Definition:</b> <a href="initializer__v2_8h_source.html#l00081">initializer_v2.h:81</a></div></div>
<div class="ttc" id="aclassio_1_1Initializer_html_a92f49c1ad4e16a85f3f0f12201cb9707"><div class="ttname"><a href="classio_1_1Initializer.html#a92f49c1ad4e16a85f3f0f12201cb9707">io::Initializer::get_vector</a></div><div class="ttdeci">std::vector&lt; T &gt; get_vector(const std::string &amp;sectionname, const std::string &amp;keyname) const</div><div class="ttdef"><b>Definition:</b> <a href="initializer__v2_8h_source.html#l00144">initializer_v2.h:144</a></div></div>
<div class="ttc" id="aclassio_1_1Initializer_html_abbf31e66329bd03f5d968988c5aa1213"><div class="ttname"><a href="classio_1_1Initializer.html#abbf31e66329bd03f5d968988c5aa1213">io::Initializer::get_verbatim</a></div><div class="ttdeci">std::string get_verbatim(const std::string &amp;sectionname, const std::string &amp;keyname) const</div><div class="ttdef"><b>Definition:</b> <a href="initializer__v2_8h_source.html#l00160">initializer_v2.h:160</a></div></div>
<div class="ttc" id="aclasspfate_1_1AdaptiveSpecies_html"><div class="ttname"><a href="classpfate_1_1AdaptiveSpecies.html">pfate::AdaptiveSpecies</a></div><div class="ttdoc">This classes extends the Species class provided by the solver to implement the evolutionary algorithm...</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__species_8h_source.html#l00027">adaptive_species.h:27</a></div></div>
<div class="ttc" id="aclasspfate_1_1AdaptiveSpecies_html_a16515855c9263b486fad79596b693726"><div class="ttname"><a href="classpfate_1_1AdaptiveSpecies.html#a16515855c9263b486fad79596b693726">pfate::AdaptiveSpecies::createVariants</a></div><div class="ttdeci">void createVariants(Model M)</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__species_8tpp_source.html#l00031">adaptive_species.tpp:31</a></div></div>
<div class="ttc" id="aclasspfate_1_1AdaptiveSpecies_html_a3434c527d0ba1e10962c678415c73501"><div class="ttname"><a href="classpfate_1_1AdaptiveSpecies.html#a3434c527d0ba1e10962c678415c73501">pfate::AdaptiveSpecies::species_name</a></div><div class="ttdeci">std::string species_name</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__species_8h_source.html#l00032">adaptive_species.h:32</a></div></div>
<div class="ttc" id="aclasspfate_1_1AdaptiveSpecies_html_a34963655822db7560d9aab4766993e55"><div class="ttname"><a href="classpfate_1_1AdaptiveSpecies.html#a34963655822db7560d9aab4766993e55">pfate::AdaptiveSpecies::r0_hist</a></div><div class="ttdeci">MovingAverager r0_hist</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__species_8h_source.html#l00045">adaptive_species.h:45</a></div></div>
<div class="ttc" id="aclasspfate_1_1AdaptiveSpecies_html_a349ba6112d565d673881c8248ab577cc"><div class="ttname"><a href="classpfate_1_1AdaptiveSpecies.html#a349ba6112d565d673881c8248ab577cc">pfate::AdaptiveSpecies::trait_scalars</a></div><div class="ttdeci">std::vector&lt; double &gt; trait_scalars</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__species_8h_source.html#l00042">adaptive_species.h:42</a></div></div>
<div class="ttc" id="aclasspfate_1_1AdaptiveSpecies_html_a35357aa983a17460c9bd68475014e258"><div class="ttname"><a href="classpfate_1_1AdaptiveSpecies.html#a35357aa983a17460c9bd68475014e258">pfate::AdaptiveSpecies::probes</a></div><div class="ttdeci">std::vector&lt; AdaptiveSpecies&lt; Model &gt; * &gt; probes</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__species_8h_source.html#l00038">adaptive_species.h:38</a></div></div>
<div class="ttc" id="aclasspfate_1_1AdaptiveSpecies_html_a44bcfeaa9449f2c6254ea36ffe063adc"><div class="ttname"><a href="classpfate_1_1AdaptiveSpecies.html#a44bcfeaa9449f2c6254ea36ffe063adc">pfate::AdaptiveSpecies::trait_variance</a></div><div class="ttdeci">std::vector&lt; double &gt; trait_variance</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__species_8h_source.html#l00041">adaptive_species.h:41</a></div></div>
<div class="ttc" id="aclasspfate_1_1AdaptiveSpecies_html_a69c96cd799aeebe19d5f4123148c93e0"><div class="ttname"><a href="classpfate_1_1AdaptiveSpecies.html#a69c96cd799aeebe19d5f4123148c93e0">pfate::AdaptiveSpecies::evolvable_traits</a></div><div class="ttdeci">std::vector&lt; std::string &gt; evolvable_traits</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__species_8h_source.html#l00039">adaptive_species.h:39</a></div></div>
<div class="ttc" id="aclasspfate_1_1AdaptiveSpecies_html_ac8d1a887bb193e1595def1e8923d3964"><div class="ttname"><a href="classpfate_1_1AdaptiveSpecies.html#ac8d1a887bb193e1595def1e8923d3964">pfate::AdaptiveSpecies::seeds_hist</a></div><div class="ttdeci">MovingAverager seeds_hist</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__species_8h_source.html#l00044">adaptive_species.h:44</a></div></div>
<div class="ttc" id="aclasspfate_1_1AdaptiveSpecies_html_ad63cdf7980f7920a48437f869c53136e"><div class="ttname"><a href="classpfate_1_1AdaptiveSpecies.html#ad63cdf7980f7920a48437f869c53136e">pfate::AdaptiveSpecies::t_introduction</a></div><div class="ttdeci">double t_introduction</div><div class="ttdoc">Time since introduction [years].</div><div class="ttdef"><b>Definition:</b> <a href="adaptive__species_8h_source.html#l00034">adaptive_species.h:34</a></div></div>
<div class="ttc" id="aclasspfate_1_1CommunityProperties_html_a46a94cdef86c8361a7aa1d71c9dd3abe"><div class="ttname"><a href="classpfate_1_1CommunityProperties.html#a46a94cdef86c8361a7aa1d71c9dd3abe">pfate::CommunityProperties::traits_file</a></div><div class="ttdeci">std::string traits_file</div><div class="ttdef"><b>Definition:</b> <a href="community__properties_8h_source.html#l00079">community_properties.h:79</a></div></div>
<div class="ttc" id="aclasspfate_1_1CommunityProperties_html_a7000f9b6f1faa3fbf24cf72800088b54"><div class="ttname"><a href="classpfate_1_1CommunityProperties.html#a7000f9b6f1faa3fbf24cf72800088b54">pfate::CommunityProperties::emgProps_file</a></div><div class="ttdeci">std::string emgProps_file</div><div class="ttdef"><b>Definition:</b> <a href="community__properties_8h_source.html#l00076">community_properties.h:76</a></div></div>
<div class="ttc" id="aclasspfate_1_1CommunityProperties_html_a77ff093b5f19fb360cc2e773d369b545"><div class="ttname"><a href="classpfate_1_1CommunityProperties.html#a77ff093b5f19fb360cc2e773d369b545">pfate::CommunityProperties::cwmAvg_file</a></div><div class="ttdeci">std::string cwmAvg_file</div><div class="ttdef"><b>Definition:</b> <a href="community__properties_8h_source.html#l00077">community_properties.h:77</a></div></div>
<div class="ttc" id="aclasspfate_1_1CommunityProperties_html_a8bec5745a8e5b1ae0a5fc5e9735d5d2a"><div class="ttname"><a href="classpfate_1_1CommunityProperties.html#a8bec5745a8e5b1ae0a5fc5e9735d5d2a">pfate::CommunityProperties::cwmperSpecies_file</a></div><div class="ttdeci">std::string cwmperSpecies_file</div><div class="ttdef"><b>Definition:</b> <a href="community__properties_8h_source.html#l00078">community_properties.h:78</a></div></div>
<div class="ttc" id="aclasspfate_1_1CommunityProperties_html_a9adebb940a7212442167bd4a5be57442"><div class="ttname"><a href="classpfate_1_1CommunityProperties.html#a9adebb940a7212442167bd4a5be57442">pfate::CommunityProperties::closeStreams</a></div><div class="ttdeci">void closeStreams()</div><div class="ttdef"><b>Definition:</b> <a href="community__properties_8cpp_source.html#l00121">community_properties.cpp:121</a></div></div>
<div class="ttc" id="aclasspfate_1_1CommunityProperties_html_ac56567794c0dd3291d53070d6ba419b0"><div class="ttname"><a href="classpfate_1_1CommunityProperties.html#ac56567794c0dd3291d53070d6ba419b0">pfate::CommunityProperties::openStreams</a></div><div class="ttdeci">void openStreams(std::string dir)</div><div class="ttdef"><b>Definition:</b> <a href="community__properties_8cpp_source.html#l00093">community_properties.cpp:93</a></div></div>
<div class="ttc" id="aclasspfate_1_1PSPM__Plant_html"><div class="ttname"><a href="classpfate_1_1PSPM__Plant.html">pfate::PSPM_Plant</a></div><div class="ttdoc">This class entends the Plant class to interface with the PSPM Solver.</div><div class="ttdef"><b>Definition:</b> <a href="pspm__interface_8h_source.html#l00022">pspm_interface.h:24</a></div></div>
<div class="ttc" id="aclasspfate_1_1PSPM__Plant_html_a47f004a9746c6c04eb34bc94b29690ff"><div class="ttname"><a href="classpfate_1_1PSPM__Plant.html#a47f004a9746c6c04eb34bc94b29690ff">pfate::PSPM_Plant::set_size</a></div><div class="ttdeci">void set_size(const std::array&lt; double, STATE_DIM &gt; &amp;_x) override</div><div class="ttdef"><b>Definition:</b> <a href="pspm__interface_8cpp_source.html#l00018">pspm_interface.cpp:18</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_a0e9956fd78450b7b554787314d0f6d99"><div class="ttname"><a href="classpfate_1_1Patch.html#a0e9956fd78450b7b554787314d0f6d99">pfate::Patch::t_next_savestate</a></div><div class="ttdeci">double t_next_savestate</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8h_source.html#l00028">plantfate_patch.h:28</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_a212f51188727deb3c00b1a9ed9d6f313"><div class="ttname"><a href="classpfate_1_1Patch.html#a212f51188727deb3c00b1a9ed9d6f313">pfate::Patch::props</a></div><div class="ttdeci">CommunityProperties props</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8h_source.html#l00044">plantfate_patch.h:44</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_a3868231658ef110c9af7af35ee9be69b"><div class="ttname"><a href="classpfate_1_1Patch.html#a3868231658ef110c9af7af35ee9be69b">pfate::Patch::ts</a></div><div class="ttdeci">flare::TimeStepper ts</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8h_source.html#l00036">plantfate_patch.h:36</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_a38f6f6d4b7e39b3bb8875f932558c715"><div class="ttname"><a href="classpfate_1_1Patch.html#a38f6f6d4b7e39b3bb8875f932558c715">pfate::Patch::S</a></div><div class="ttdeci">Solver S</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8h_source.html#l00039">plantfate_patch.h:39</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_a47e6e817aab6c4aa75992eb71fb09cb6"><div class="ttname"><a href="classpfate_1_1Patch.html#a47e6e817aab6c4aa75992eb71fb09cb6">pfate::Patch::climate_stream</a></div><div class="ttdeci">env::ClimateStream climate_stream</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8h_source.html#l00035">plantfate_patch.h:35</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_a59eda2b21a7d954f754ecdf07a36e198"><div class="ttname"><a href="classpfate_1_1Patch.html#a59eda2b21a7d954f754ecdf07a36e198">pfate::Patch::E</a></div><div class="ttdeci">PSPM_Environment E</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8h_source.html#l00040">plantfate_patch.h:40</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_a65bb4cfd0e87dd7017811a6ff1737722"><div class="ttname"><a href="classpfate_1_1Patch.html#a65bb4cfd0e87dd7017811a6ff1737722">pfate::Patch::set_a_metFile</a></div><div class="ttdeci">void set_a_metFile(std::string file)</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8cpp_source.html#l00071">plantfate_patch.cpp:71</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_a6b6b7ac3f4a4017b2f534279fc7afec3"><div class="ttname"><a href="classpfate_1_1Patch.html#a6b6b7ac3f4a4017b2f534279fc7afec3">pfate::Patch::t_next_invasion</a></div><div class="ttdeci">double t_next_invasion</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8h_source.html#l00027">plantfate_patch.h:27</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_a84fd2d29e9e81ff264d783499825863e"><div class="ttname"><a href="classpfate_1_1Patch.html#a84fd2d29e9e81ff264d783499825863e">pfate::Patch::config</a></div><div class="ttdeci">PlantFateConfig config</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8h_source.html#l00024">plantfate_patch.h:24</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_a871b9cac7034dc81fb04449971952570"><div class="ttname"><a href="classpfate_1_1Patch.html#a871b9cac7034dc81fb04449971952570">pfate::Patch::t_next_writestate</a></div><div class="ttdeci">double t_next_writestate</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8h_source.html#l00029">plantfate_patch.h:29</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_a9e206a8b8ffc34c68e42a30eaf096461"><div class="ttname"><a href="classpfate_1_1Patch.html#a9e206a8b8ffc34c68e42a30eaf096461">pfate::Patch::runif</a></div><div class="ttdeci">double runif(double rmin=0, double rmax=1)</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8cpp_source.html#l00224">plantfate_patch.cpp:224</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_ab4c96a4ee454126766b0f135228643df"><div class="ttname"><a href="classpfate_1_1Patch.html#ab4c96a4ee454126766b0f135228643df">pfate::Patch::traits0</a></div><div class="ttdeci">plant::PlantTraits traits0</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8h_source.html#l00032">plantfate_patch.h:32</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_ab58a899c33839507b147bc7a59a2d5c2"><div class="ttname"><a href="classpfate_1_1Patch.html#ab58a899c33839507b147bc7a59a2d5c2">pfate::Patch::readTraitsFromFile</a></div><div class="ttdeci">std::vector&lt; plant::PlantTraits &gt; readTraitsFromFile(std::string fname)</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8cpp_source.html#l00083">plantfate_patch.cpp:83</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_ab76971ff4ca9bf75128d6bbe186d9456"><div class="ttname"><a href="classpfate_1_1Patch.html#ab76971ff4ca9bf75128d6bbe186d9456">pfate::Patch::close</a></div><div class="ttdeci">void close()</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8cpp_source.html#l00209">plantfate_patch.cpp:209</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_ab87c46fbd0576bb7031cb3ca8dbe7126"><div class="ttname"><a href="classpfate_1_1Patch.html#ab87c46fbd0576bb7031cb3ca8dbe7126">pfate::Patch::set_i_metFile</a></div><div class="ttdeci">void set_i_metFile(std::string file)</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8cpp_source.html#l00065">plantfate_patch.cpp:65</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_ac014924ea9c6590fa2031788057cf271"><div class="ttname"><a href="classpfate_1_1Patch.html#ac014924ea9c6590fa2031788057cf271">pfate::Patch::addSpeciesAndProbes</a></div><div class="ttdeci">void addSpeciesAndProbes(double t, const plant::PlantTraits &amp;traits)</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8cpp_source.html#l00246">plantfate_patch.cpp:246</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_ad2e4b86b03a6a6834a363bf19c1d9587"><div class="ttname"><a href="classpfate_1_1Patch.html#ad2e4b86b03a6a6834a363bf19c1d9587">pfate::Patch::init</a></div><div class="ttdeci">void init(double tstart, double tend)</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8cpp_source.html#l00129">plantfate_patch.cpp:129</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_ad6da7a3a21e9237ca8cd1e4a631b06b3"><div class="ttname"><a href="classpfate_1_1Patch.html#ad6da7a3a21e9237ca8cd1e4a631b06b3">pfate::Patch::t_next_disturbance</a></div><div class="ttdeci">double t_next_disturbance</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8h_source.html#l00026">plantfate_patch.h:26</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_ae3329fc40060265528e302fd75bd3b20"><div class="ttname"><a href="classpfate_1_1Patch.html#ae3329fc40060265528e302fd75bd3b20">pfate::Patch::set_co2File</a></div><div class="ttdeci">void set_co2File(std::string co2file)</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8cpp_source.html#l00077">plantfate_patch.cpp:77</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_ae819ff5787441c244a4b0414b3153761"><div class="ttname"><a href="classpfate_1_1Patch.html#ae819ff5787441c244a4b0414b3153761">pfate::Patch::removeSpeciesAndProbes</a></div><div class="ttdeci">void removeSpeciesAndProbes(AdaptiveSpecies&lt; PSPM_Plant &gt; *spp)</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8cpp_source.html#l00230">plantfate_patch.cpp:230</a></div></div>
<div class="ttc" id="aclasspfate_1_1Patch_html_af40afab09d5713fb4d351b596cd65f70"><div class="ttname"><a href="classpfate_1_1Patch.html#af40afab09d5713fb4d351b596cd65f70">pfate::Patch::par0</a></div><div class="ttdeci">plant::PlantParameters par0</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__patch_8h_source.html#l00031">plantfate_patch.h:31</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a19c5c9eff1e66dc0ec75773ed60738ff"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a19c5c9eff1e66dc0ec75773ed60738ff">pfate::PlantFateConfig::out_dir</a></div><div class="ttdeci">std::string out_dir</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00014">plantfate_config.h:14</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a1e0a61fd7e98e6af00ed1bebdad96a0d"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a1e0a61fd7e98e6af00ed1bebdad96a0d">pfate::PlantFateConfig::evolvable_traits</a></div><div class="ttdeci">std::vector&lt; std::string &gt; evolvable_traits</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00050">plantfate_config.h:50</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a3065c149095f1c4a4a2e3aa818a59b35"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a3065c149095f1c4a4a2e3aa818a59b35">pfate::PlantFateConfig::traits_file</a></div><div class="ttdeci">std::string traits_file</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00031">plantfate_config.h:31</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a3f90f885ff0084b1a809159266326bd8"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a3f90f885ff0084b1a809159266326bd8">pfate::PlantFateConfig::yf</a></div><div class="ttdeci">double yf</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00036">plantfate_config.h:36</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a55554e3624281674ee3d8036b765b269"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a55554e3624281674ee3d8036b765b269">pfate::PlantFateConfig::trait_variances</a></div><div class="ttdeci">std::vector&lt; double &gt; trait_variances</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00051">plantfate_config.h:51</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a5852215889d3dad7d991bf0fc38ec2cf"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a5852215889d3dad7d991bf0fc38ec2cf">pfate::PlantFateConfig::ye</a></div><div class="ttdeci">double ye</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00037">plantfate_config.h:37</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a594eff216fc1ea43f19617a91029b66b"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a594eff216fc1ea43f19617a91029b66b">pfate::PlantFateConfig::T_return</a></div><div class="ttdeci">double T_return</div><div class="ttdoc">Return interval of disturbance (patch clearance)</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00043">plantfate_config.h:43</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a5d5e7a4551c9d1471007af8c52058497"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a5d5e7a4551c9d1471007af8c52058497">pfate::PlantFateConfig::res</a></div><div class="ttdeci">double res</div><div class="ttdoc">initial resolution on size axis - remains constant for fixed-mesh methods</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00046">plantfate_config.h:46</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a5e73008435155be5196fd656dfe59b72"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a5e73008435155be5196fd656dfe59b72">pfate::PlantFateConfig::expt_dir</a></div><div class="ttdeci">std::string expt_dir</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00015">plantfate_config.h:15</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a5fff78aefd0dc56845f779ec91f4768c"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a5fff78aefd0dc56845f779ec91f4768c">pfate::PlantFateConfig::T_r0_avg</a></div><div class="ttdeci">double T_r0_avg</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00053">plantfate_config.h:53</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a6717b761d1daecbcc4bef004536056c8"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a6717b761d1daecbcc4bef004536056c8">pfate::PlantFateConfig::continueFrom_stateFile</a></div><div class="ttdeci">std::string continueFrom_stateFile</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00025">plantfate_config.h:25</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a6999f4826cfb1a2218024aa1a6b15ba7"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a6999f4826cfb1a2218024aa1a6b15ba7">pfate::PlantFateConfig::continuePrevious</a></div><div class="ttdeci">bool continuePrevious</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00027">plantfate_config.h:27</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a69c436aba73769ab35e14ca682fa23cf"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a69c436aba73769ab35e14ca682fa23cf">pfate::PlantFateConfig::trait_scalars</a></div><div class="ttdeci">std::vector&lt; double &gt; trait_scalars</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00052">plantfate_config.h:52</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a6b204d0bce09370761635535cb60bf07"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a6b204d0bce09370761635535cb60bf07">pfate::PlantFateConfig::state_outfile</a></div><div class="ttdeci">std::string state_outfile</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00022">plantfate_config.h:22</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a720f50305169ef2ea26ae9af444da578"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a720f50305169ef2ea26ae9af444da578">pfate::PlantFateConfig::T_seed_rain_avg</a></div><div class="ttdeci">double T_seed_rain_avg</div><div class="ttdoc">Interval over which seed rains should be averaged (multi-patch dynamics)</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00042">plantfate_config.h:42</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a749fe89bba82133621f74abb7396f679"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a749fe89bba82133621f74abb7396f679">pfate::PlantFateConfig::T_invasion</a></div><div class="ttdeci">double T_invasion</div><div class="ttdoc">Interval between successive species invasions.</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00044">plantfate_config.h:44</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a82df543b02a52b078aaff2b37ebead7b"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a82df543b02a52b078aaff2b37ebead7b">pfate::PlantFateConfig::T_cohort_insertion</a></div><div class="ttdeci">double T_cohort_insertion</div><div class="ttdoc">Interval after which cohorts should be inserted, if using IEBT solver.</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00041">plantfate_config.h:41</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a872cb2468008a706cfb6649c92a97046"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a872cb2468008a706cfb6649c92a97046">pfate::PlantFateConfig::evolve_traits</a></div><div class="ttdeci">bool evolve_traits</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00032">plantfate_config.h:32</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a8b99db3e97cf02acb4e2bcb7659754ff"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a8b99db3e97cf02acb4e2bcb7659754ff">pfate::PlantFateConfig::n_species</a></div><div class="ttdeci">int n_species</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00030">plantfate_config.h:30</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a93041d531e5ae055bf58bcc121296cb5"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a93041d531e5ae055bf58bcc121296cb5">pfate::PlantFateConfig::save_state</a></div><div class="ttdeci">bool save_state</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00021">plantfate_config.h:21</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_a975623dd07c76d5b78ee98de0583fc6b"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#a975623dd07c76d5b78ee98de0583fc6b">pfate::PlantFateConfig::saveStateInterval</a></div><div class="ttdeci">int saveStateInterval</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00028">plantfate_config.h:28</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_aa025879039df4f87e5ec44e6c70e5219"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#aa025879039df4f87e5ec44e6c70e5219">pfate::PlantFateConfig::time_unit</a></div><div class="ttdeci">std::string time_unit</div><div class="ttdoc">Time unit in which all time points and intervals are specified. E.g. days since 1850-01-01.</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00039">plantfate_config.h:39</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_aae7cb6e9ee616849fcc51030c66d572c"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#aae7cb6e9ee616849fcc51030c66d572c">pfate::PlantFateConfig::config_outfile</a></div><div class="ttdeci">std::string config_outfile</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00023">plantfate_config.h:23</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_ac75e323e6e233456b09bb02d1012b04e"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#ac75e323e6e233456b09bb02d1012b04e">pfate::PlantFateConfig::y0</a></div><div class="ttdeci">double y0</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00035">plantfate_config.h:35</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_ad51c006836c8948de58f22f4f7175427"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#ad51c006836c8948de58f22f4f7175427">pfate::PlantFateConfig::timestep</a></div><div class="ttdeci">double timestep</div><div class="ttdoc">Simulation timestep: Patches are stepped at this timestep and computations before/after timstep are d...</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00040">plantfate_config.h:40</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_adb27144cda596255f54b7f0d3abe7dde"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#adb27144cda596255f54b7f0d3abe7dde">pfate::PlantFateConfig::parent_dir</a></div><div class="ttdeci">std::string parent_dir</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00015">plantfate_config.h:15</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_adc1adec1b45bcfc93c1fb79535ba9251"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#adc1adec1b45bcfc93c1fb79535ba9251">pfate::PlantFateConfig::continueFrom_configFile</a></div><div class="ttdeci">std::string continueFrom_configFile</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00026">plantfate_config.h:26</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_ae742654848928a5dbd2379e262f11eb9"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#ae742654848928a5dbd2379e262f11eb9">pfate::PlantFateConfig::paramsFile</a></div><div class="ttdeci">std::string paramsFile</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00012">plantfate_config.h:12</a></div></div>
<div class="ttc" id="aclasspfate_1_1PlantFateConfig_html_af748396e17b30f9a17d1f9473e3804f2"><div class="ttname"><a href="classpfate_1_1PlantFateConfig.html#af748396e17b30f9a17d1f9473e3804f2">pfate::PlantFateConfig::solver_method</a></div><div class="ttdeci">std::string solver_method</div><div class="ttdef"><b>Definition:</b> <a href="plantfate__config_8h_source.html#l00048">plantfate_config.h:48</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1Clim_html"><div class="ttname"><a href="classpfate_1_1env_1_1Clim.html">pfate::env::Clim</a></div><div class="ttdef"><b>Definition:</b> <a href="climate_8h_source.html#l00015">climate.h:15</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1Clim_html_a159900b7ce44d139c614053e3c28ab27"><div class="ttname"><a href="classpfate_1_1env_1_1Clim.html#a159900b7ce44d139c614053e3c28ab27">pfate::env::Clim::vpd</a></div><div class="ttdeci">double vpd</div><div class="ttdoc">Vapour pressure deficit [Pa].</div><div class="ttdef"><b>Definition:</b> <a href="climate_8h_source.html#l00020">climate.h:20</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1Clim_html_a589215b140b29e2e21032e095b9d2326"><div class="ttname"><a href="classpfate_1_1env_1_1Clim.html#a589215b140b29e2e21032e095b9d2326">pfate::env::Clim::swp</a></div><div class="ttdeci">double swp</div><div class="ttdoc">Soil water potential [MPa].</div><div class="ttdef"><b>Definition:</b> <a href="climate_8h_source.html#l00023">climate.h:23</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1Clim_html_a5d097a8175dfb82053fff2c5c655e88e"><div class="ttname"><a href="classpfate_1_1env_1_1Clim.html#a5d097a8175dfb82053fff2c5c655e88e">pfate::env::Clim::rn</a></div><div class="ttdeci">double rn</div><div class="ttdoc">Net radiation at surface [W m-2].</div><div class="ttdef"><b>Definition:</b> <a href="climate_8h_source.html#l00019">climate.h:19</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1Clim_html_a63b47078aa082c156901e63496189c9e"><div class="ttname"><a href="classpfate_1_1env_1_1Clim.html#a63b47078aa082c156901e63496189c9e">pfate::env::Clim::ppfd</a></div><div class="ttdeci">double ppfd</div><div class="ttdoc">PAR (daily 24-hr mean) [umol m-2 s-1].</div><div class="ttdef"><b>Definition:</b> <a href="climate_8h_source.html#l00018">climate.h:18</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1Clim_html_a99d684eb015402b31bdaed6a71fafb39"><div class="ttname"><a href="classpfate_1_1env_1_1Clim.html#a99d684eb015402b31bdaed6a71fafb39">pfate::env::Clim::co2</a></div><div class="ttdeci">double co2</div><div class="ttdoc">Atmospheric CO2 [ppm].</div><div class="ttdef"><b>Definition:</b> <a href="climate_8h_source.html#l00021">climate.h:21</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1Clim_html_aa3e81becece17a678bc6e7babbae5df7"><div class="ttname"><a href="classpfate_1_1env_1_1Clim.html#aa3e81becece17a678bc6e7babbae5df7">pfate::env::Clim::tc</a></div><div class="ttdeci">double tc</div><div class="ttdoc">Temperature [C].</div><div class="ttdef"><b>Definition:</b> <a href="climate_8h_source.html#l00017">climate.h:17</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1ClimateStream_html"><div class="ttname"><a href="classpfate_1_1env_1_1ClimateStream.html">pfate::env::ClimateStream</a></div><div class="ttdef"><b>Definition:</b> <a href="climate__stream_8h_source.html#l00017">climate_stream.h:17</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1ClimateStream_html_a145bdd904cb4c5a638885e4a30715fdc"><div class="ttname"><a href="classpfate_1_1env_1_1ClimateStream.html#a145bdd904cb4c5a638885e4a30715fdc">pfate::env::ClimateStream::update_co2</a></div><div class="ttdeci">bool update_co2</div><div class="ttdef"><b>Definition:</b> <a href="climate__stream_8h_source.html#l00029">climate_stream.h:29</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1ClimateStream_html_a259d5b50ebd9d8e801ee6cd079f6fb75"><div class="ttname"><a href="classpfate_1_1env_1_1ClimateStream.html#a259d5b50ebd9d8e801ee6cd079f6fb75">pfate::env::ClimateStream::updateClimate</a></div><div class="ttdeci">void updateClimate(double julian_time, Climate &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="climate__stream_8cpp_source.html#l00028">climate_stream.cpp:28</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1ClimateStream_html_a80128e3f20c12e21640986daf17798e8"><div class="ttname"><a href="classpfate_1_1env_1_1ClimateStream.html#a80128e3f20c12e21640986daf17798e8">pfate::env::ClimateStream::i_metFile</a></div><div class="ttdeci">std::string i_metFile</div><div class="ttdef"><b>Definition:</b> <a href="climate__stream_8h_source.html#l00023">climate_stream.h:23</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1ClimateStream_html_a8041d11c8f2968d520a88da9d278fb54"><div class="ttname"><a href="classpfate_1_1env_1_1ClimateStream.html#a8041d11c8f2968d520a88da9d278fb54">pfate::env::ClimateStream::update_i_met</a></div><div class="ttdeci">bool update_i_met</div><div class="ttdef"><b>Definition:</b> <a href="climate__stream_8h_source.html#l00027">climate_stream.h:27</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1ClimateStream_html_a90812d927002af407680ea3182c98e58"><div class="ttname"><a href="classpfate_1_1env_1_1ClimateStream.html#a90812d927002af407680ea3182c98e58">pfate::env::ClimateStream::update_a_met</a></div><div class="ttdeci">bool update_a_met</div><div class="ttdef"><b>Definition:</b> <a href="climate__stream_8h_source.html#l00028">climate_stream.h:28</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1ClimateStream_html_ae27089c4b9fb1b1547b985a1cf502e42"><div class="ttname"><a href="classpfate_1_1env_1_1ClimateStream.html#ae27089c4b9fb1b1547b985a1cf502e42">pfate::env::ClimateStream::co2File</a></div><div class="ttdeci">std::string co2File</div><div class="ttdef"><b>Definition:</b> <a href="climate__stream_8h_source.html#l00025">climate_stream.h:25</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1ClimateStream_html_af886bf0c88d29c9460067a124c000f3d"><div class="ttname"><a href="classpfate_1_1env_1_1ClimateStream.html#af886bf0c88d29c9460067a124c000f3d">pfate::env::ClimateStream::init</a></div><div class="ttdeci">void init()</div><div class="ttdef"><b>Definition:</b> <a href="climate__stream_8cpp_source.html#l00006">climate_stream.cpp:6</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1ClimateStream_html_afeb41c6b8bdc66fe10bdb2ea02aa0ab4"><div class="ttname"><a href="classpfate_1_1env_1_1ClimateStream.html#afeb41c6b8bdc66fe10bdb2ea02aa0ab4">pfate::env::ClimateStream::a_metFile</a></div><div class="ttdeci">std::string a_metFile</div><div class="ttdef"><b>Definition:</b> <a href="climate__stream_8h_source.html#l00024">climate_stream.h:24</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1Climate_html_a75a84463176cf6c2c86192959fdb686b"><div class="ttname"><a href="classpfate_1_1env_1_1Climate.html#a75a84463176cf6c2c86192959fdb686b">pfate::env::Climate::set_elevation</a></div><div class="ttdeci">void set_elevation(double _elv)</div><div class="ttdef"><b>Definition:</b> <a href="climate_8cpp_source.html#l00071">climate.cpp:71</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1Climate_html_ad15a02a1fa35c5d34d8b46f4a58421fb"><div class="ttname"><a href="classpfate_1_1env_1_1Climate.html#ad15a02a1fa35c5d34d8b46f4a58421fb">pfate::env::Climate::set_acclim_timescale</a></div><div class="ttdeci">void set_acclim_timescale(double tau)</div><div class="ttdoc">Set acclimation timescale.</div><div class="ttdef"><b>Definition:</b> <a href="climate_8cpp_source.html#l00086">climate.cpp:86</a></div></div>
<div class="ttc" id="aclasspfate_1_1env_1_1LightEnvironment_html_a27588f976abcb0b5e32271cb475c2ee6"><div class="ttname"><a href="classpfate_1_1env_1_1LightEnvironment.html#a27588f976abcb0b5e32271cb475c2ee6">pfate::env::LightEnvironment::use_ppa</a></div><div class="ttdeci">bool use_ppa</div><div class="ttdef"><b>Definition:</b> <a href="light__environment_8h_source.html#l00014">light_environment.h:14</a></div></div>
<div class="ttc" id="aclassplant_1_1PlantParameters_html_a6f4ee512f917665608504a6a893d92f3"><div class="ttname"><a href="classplant_1_1PlantParameters.html#a6f4ee512f917665608504a6a893d92f3">plant::PlantParameters::init</a></div><div class="ttdeci">void init(io::Initializer &amp;I)</div><div class="ttdef"><b>Definition:</b> <a href="traits__params_8cpp_source.html#l00158">traits_params.cpp:158</a></div></div>
<div class="ttc" id="aclassplant_1_1PlantParameters_html_a7a0dc41bcb06a66292f3040918893c4b"><div class="ttname"><a href="classplant_1_1PlantParameters.html#a7a0dc41bcb06a66292f3040918893c4b">plant::PlantParameters::set_tscale</a></div><div class="ttdeci">void set_tscale(double tscale)</div><div class="ttdef"><b>Definition:</b> <a href="traits__params_8cpp_source.html#l00215">traits_params.cpp:215</a></div></div>
<div class="ttc" id="aclassplant_1_1PlantTraits_html"><div class="ttname"><a href="classplant_1_1PlantTraits.html">plant::PlantTraits</a></div><div class="ttdef"><b>Definition:</b> <a href="traits__params_8h_source.html#l00015">traits_params.h:15</a></div></div>
<div class="ttc" id="aclassplant_1_1PlantTraits_html_a0d988211ceeb41469feff46a048fa956"><div class="ttname"><a href="classplant_1_1PlantTraits.html#a0d988211ceeb41469feff46a048fa956">plant::PlantTraits::p50_xylem</a></div><div class="ttdeci">double p50_xylem</div><div class="ttdoc">Xylem hydraulic vulnerability [MPa].</div><div class="ttdef"><b>Definition:</b> <a href="traits__params_8h_source.html#l00031">traits_params.h:31</a></div></div>
<div class="ttc" id="aclassplant_1_1PlantTraits_html_a4cd6d86786c24681481457ecaa322f3f"><div class="ttname"><a href="classplant_1_1PlantTraits.html#a4cd6d86786c24681481457ecaa322f3f">plant::PlantTraits::wood_density</a></div><div class="ttdeci">double wood_density</div><div class="ttdoc">[kg/m3]</div><div class="ttdef"><b>Definition:</b> <a href="traits__params_8h_source.html#l00030">traits_params.h:30</a></div></div>
<div class="ttc" id="aclassplant_1_1PlantTraits_html_a6e76d3f69afac02fc28949acc713936b"><div class="ttname"><a href="classplant_1_1PlantTraits.html#a6e76d3f69afac02fc28949acc713936b">plant::PlantTraits::species_name</a></div><div class="ttdeci">std::string species_name</div><div class="ttdef"><b>Definition:</b> <a href="traits__params_8h_source.html#l00020">traits_params.h:20</a></div></div>
<div class="ttc" id="aclassplant_1_1PlantTraits_html_a752ff5e88101f3002440c3cd8879cf31"><div class="ttname"><a href="classplant_1_1PlantTraits.html#a752ff5e88101f3002440c3cd8879cf31">plant::PlantTraits::init</a></div><div class="ttdeci">void init(io::Initializer &amp;I)</div><div class="ttdef"><b>Definition:</b> <a href="traits__params_8cpp_source.html#l00025">traits_params.cpp:25</a></div></div>
<div class="ttc" id="aclassplant_1_1PlantTraits_html_a9c0407f9468478d653f2b5b776ab227b"><div class="ttname"><a href="classplant_1_1PlantTraits.html#a9c0407f9468478d653f2b5b776ab227b">plant::PlantTraits::hmat</a></div><div class="ttdeci">double hmat</div><div class="ttdoc">height at maturity [m]</div><div class="ttdef"><b>Definition:</b> <a href="traits__params_8h_source.html#l00027">traits_params.h:27</a></div></div>
<div class="ttc" id="aclassplant_1_1PlantTraits_html_abdfad8afcd127e5d5627095f278cf1b1"><div class="ttname"><a href="classplant_1_1PlantTraits.html#abdfad8afcd127e5d5627095f278cf1b1">plant::PlantTraits::lma</a></div><div class="ttdeci">double lma</div><div class="ttdoc">leaf mass per leaf area [kg/m2]</div><div class="ttdef"><b>Definition:</b> <a href="traits__params_8h_source.html#l00024">traits_params.h:24</a></div></div>
<div class="ttc" id="aclassplant_1_1Plant_html"><div class="ttname"><a href="classplant_1_1Plant.html">plant::Plant</a></div><div class="ttdoc">The class for an individual plant.</div><div class="ttdef"><b>Definition:</b> <a href="plant_8h_source.html#l00018">plant.h:18</a></div></div>
<div class="ttc" id="aclassplant_1_1Plant_html_a99d31208f7afa12bc10ee138bf190ef8"><div class="ttname"><a href="classplant_1_1Plant.html#a99d31208f7afa12bc10ee138bf190ef8">plant::Plant::init</a></div><div class="ttdeci">void init(const PlantParameters &amp;_par, const PlantTraits &amp;_traits)</div><div class="ttdoc">This function initializes the plant (traits, par, and geometry) from params and traits objects.</div><div class="ttdef"><b>Definition:</b> <a href="plant_8cpp_source.html#l00008">plant.cpp:8</a></div></div>
<div class="ttc" id="anamespacepfate_html"><div class="ttname"><a href="namespacepfate.html">pfate</a></div><div class="ttdef"><b>Definition:</b> <a href="adaptive__species_8tpp_source.html#l00001">adaptive_species.tpp:1</a></div></div>
<div class="ttc" id="anamespacepfate_html_aa3b7425f62503d7549ea5237bccee611"><div class="ttname"><a href="namespacepfate.html#aa3b7425f62503d7549ea5237bccee611">pfate::saveState</a></div><div class="ttdeci">void saveState(Patch &amp;P, string state_outfile, string config_outfile, string params_file)</div><div class="ttdef"><b>Definition:</b> <a href="state__restore_8cpp_source.html#l00008">state_restore.cpp:8</a></div></div>
<div class="ttc" id="anamespacepfate_html_acf2c2a4b2aac6abc0c2c61691e3b0f21"><div class="ttname"><a href="namespacepfate.html#acf2c2a4b2aac6abc0c2c61691e3b0f21">pfate::restoreState</a></div><div class="ttdeci">void restoreState(Patch &amp;P, string state_infile, string config_infile)</div><div class="ttdef"><b>Definition:</b> <a href="state__restore_8cpp_source.html#l00034">state_restore.cpp:34</a></div></div>
<div class="ttc" id="aplantfate__patch_8h_html"><div class="ttname"><a href="plantfate__patch_8h.html">plantfate_patch.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="plantfate__patch_8cpp.html">plantfate_patch.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
